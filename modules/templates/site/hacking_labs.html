<!-- /modules/templates/site/hacking_labs.html -->
{% extends 'base.html' %}

{% block content %}
{% with messages = get_flashed_messages() %}
{% if messages %}
<div>
    {% for message in messages %}
    <div class="alert alert-info" role="alert">{{ message }}</div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}
<script src="{{ url_for('static', filename='js/flag_submission.js') }}"></script>
<div class="container">
                    <!-- Modal -->
                    <div id="flagModal" class="modal">
                        <div class="modal-content">
                            <span id="modalEmoticon" class="modal-emoticon"></span>
                            <p id="modalMessage"></p>
                        </div>
                    </div>
    <div class="glass-panel">
        <div class="labs_title">
            <h1>HACKPLANET.EU LABS</h1>
        </div>

    {% for lab in labs %}
    <div class="lab">

        <div class="labschip">

            <h2>{{ lab.name }}</h2>
            {% if lab.image %}
            <img src="{{ url_for('static', filename='library/images/labs/' + lab.image) }}" alt="{{ lab.name }}" class="lab-image">
            {% endif %}
            {% if lab.vpn_file %}
            <a href="{{ '/static/library/labs/' + lab.vpn_file }}" class="download-button btn btn-primary">Download Lab Access</a>
            {% endif %}
            <p>{{ lab.description }}</p>
        </div>

        <div class="hosts">

            {% for host in lab.hosts %}
            <div class="host">

                <h3>{{ host.name }} {{ host.id }}</h3>
                <div class="host-image-container">
                    <img src="{{ '/static/library/images/' + host.image_url }}" alt="{{ host.name }}" class="host-image">
                </div>
                <p>IP Address: {{ host.ip }}</p>
                <p>Difficulty: {{ host.difficulty }} {% if host.difficulty == 1 %}ğŸ˜Š{% elif host.difficulty == 2 %}ğŸ™‚{% elif host.difficulty == 3 %}ğŸ˜{% elif host.difficulty == 4 %}ğŸ˜•{% elif host.difficulty == 5 %}ğŸ˜Ÿ{% elif host.difficulty == 6 %}ğŸ˜¦{% elif host.difficulty == 7 %}ğŸ˜§{% elif host.difficulty == 8 %}ğŸ˜¨{% elif host.difficulty == 9 %}ğŸ˜°{% elif host.difficulty == 10 %}ğŸ˜±{% endif %}</p>
                <p>Status: {{ 'Online' if host.status else 'Offline' }}</p>
                <p>Rating: {% for _ in range(host.rating) %}â˜…{% endfor %}{% for _ in range(5 - host.rating) %}â˜†{% endfor %}</p>
                {% if is_admin %}
                <div class="flags">
                    <p style="font-size: 0.2em;">User Flag: {{ host.flags|selectattr('type', '==', 'user')|map(attribute='uuid')|first }}</p>
                    <p style="font-size: 0.2em;">Root Flag: {{ host.flags|selectattr('type', '==', 'root')|map(attribute='uuid')|first }}</p>
                </div>
                {% endif %}

                <div class="host-inputarea">
                    {% if host.name != 'kalismurf' %}
                    <div class="flag-input-container">
                        <input type="text" id="user-flag-{{ host.id }}" placeholder="Enter User Flag" class="flag-input">
                        <button type="button" class="btn btn-success" onclick="submitFlag('{{ host.id }}', 'user')">Submit</button>
                    </div>
                    <div class="flag-input-container">
                        <input type="text" id="root-flag-{{ host.id }}" placeholder="Enter Root Flag" class="flag-input">
                        <button type="button" class="btn btn-danger" onclick="submitFlag('{{ host.id }}', 'root')">Submit</button>
                    </div>
                    {% else %}
                    <div class="kalismurf-credentials">
                        <p>username : kali</p>
                        <p>password : KaliLinux2024!</p>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
 
    </div>
    {% endfor %}
</div>



{% endblock %}
